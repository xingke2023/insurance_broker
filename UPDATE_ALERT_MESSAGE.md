# 修改任务开始提示信息和界面重置

## 修改内容

将"开始分析"后的弹窗从**询问式**改为**提示式**，并在用户确认后**重置界面**，允许继续上传新文件。

## 修改前

```javascript
// 点击"确定"会返回首页，点击"取消"继续等待
const shouldReturn = window.confirm(
  '任务已开始处理，您可以返回继续其他操作，系统会在后台继续处理。\n\n' +
  '点击"确定"返回首页，点击"取消"继续等待。'
);
if (shouldReturn) {
    handleNavigateHome();
}
```

**用户体验问题**：
- 用户点击"确定"会被强制返回首页
- 很多用户习惯性点"确定"，导致意外离开当前页面
- 不够友好

## 修改后

```javascript
// 纯提示信息，点击"确定"后重置界面
alert(
  '任务已开始处理！\n\n' +
  '任务将在后台继续处理，您可以：\n' +
  '• 在"后台任务"中查看进度和结果\n' +
  '• 继续上传新文件进行分析\n' +
  '• 点击"返回首页"按钮返回'
);

// 重置界面状态
setIsProcessing(false);          // 重置"开始分析"按钮
setProgress({ step: 0, ... });   // 清除进度显示

// 关闭WebSocket，任务继续在后台运行
if (websocket) {
    websocket.close();
}
```

**改进点**：
- ✅ 点击"确定"后停留在当前页面
- ✅ **自动重置"开始分析"按钮**，可以立即分析新文件
- ✅ 清除当前进度显示，界面恢复初始状态
- ✅ 任务在后台继续处理，不受影响
- ✅ 用户体验更友好，支持**并行处理多个文件**

## 用户行为流程

### 修改前
```
点击"开始分析"
  ↓
弹窗询问："确定返回？取消等待？"
  ↓
点击"确定" → 强制返回首页 ❌
点击"取消" → 继续等待 ✅
```

### 修改后
```
点击"开始分析"
  ↓
任务提交到后台
  ↓
弹窗提示："任务已开始！可以继续上传、查看任务或返回"
  ↓
点击"确定" → 界面自动重置 ✅
  ↓
"开始分析"按钮恢复可用状态 ✅
  ↓
用户可以：
  ✅ 立即上传新文件继续分析（并行处理）
  ✅ 点击"后台任务"查看所有任务进度
  ✅ 点击"返回首页"返回
```

## 修改位置

**文件**: `frontend/src/components/PlanAnalyzer.jsx`

**行号**: 318-330

## 关键调整

1. **提示信息更新**
   - 明确告知任务在后台处理
   - 列出用户可以进行的操作

2. **界面重置**
   ```javascript
   setIsProcessing(false);          // 恢复"开始分析"按钮
   setProgress({ step: 0, ... });   // 清除进度显示
   ```

3. **WebSocket断开**
   ```javascript
   if (websocket) {
       websocket.close();  // 关闭连接，释放资源
   }
   ```
   - 任务继续在后台运行
   - 可通过"后台任务"查看进度

4. **弹窗延迟**
   - 从 `2000ms` 改为 `1000ms`（更快响应）

5. **删除自动跳转**
   - 删除了 `handleNavigateHome()` 的调用逻辑

## 构建状态

✅ 构建成功
```bash
✓ built in 3.73s
```

## 测试步骤

### 测试1：基本流程
1. 上传文件（例如：test1.pdf）
2. 点击"开始分析"
3. 1秒后弹出提示
4. 点击"确定"
5. **验证**：
   - ✅ 停留在当前页面
   - ✅ "开始分析"按钮恢复可用状态
   - ✅ 进度显示清空
   - ✅ 页面右上角"后台任务"显示数字标记

### 测试2：并行处理
1. 完成测试1后
2. 立即上传新文件（例如：test2.pdf）
3. 点击"开始分析"
4. **验证**：
   - ✅ 可以立即开始分析第二个文件
   - ✅ 点击"后台任务"能看到两个任务在并行处理
   - ✅ 每个任务独立显示进度

### 测试3：查看后台任务
1. 点击右上角"后台任务"按钮
2. **验证**：
   - ✅ 显示所有已提交的任务
   - ✅ 每个任务显示实时进度百分比
   - ✅ 完成的任务可以点击"查看结果"

## 修改日期

2025-01-06
