# PDF拖动选择擦除功能 - 使用指南

📅 **更新日期**: 2025-12-17
✨ **新功能**: 拖动鼠标直接选择擦除区域，无需手动输入坐标！

---

## 🎯 功能亮点

**所见即所得的交互方式**：
- 🖱️ **拖动选择**：直接在PDF预览上拖动鼠标框选区域
- 🎨 **实时反馈**：黄色→绿色→紫色，清晰的视觉状态
- ⚡ **快速操作**：3步完成擦除区域添加
- 📍 **精确定位**：自动计算坐标和尺寸

---

## 🚀 使用步骤

### 步骤1: 上传PDF并打开预览
1. 上传PDF文件
2. 电脑端自动显示预览（移动端点击"预览"按钮）
3. 切换到需要擦除内容的页面

### 步骤2: 进入选择模式
点击左侧"自定义矩形擦除"区域的 **"拖动选择区域"** 按钮
- 按钮变为黄色表示已激活
- 鼠标光标变为十字准星 ➕
- 预览右上角显示"拖动选择模式"标签

### 步骤3: 拖动选择区域
在预览的PDF页面上：
1. **按住鼠标左键**
2. **拖动**到目标位置
3. **释放鼠标**

**实时视觉反馈**：
- 🟡 **拖动中**：黄色半透明矩形，显示实时尺寸
- 🟢 **选中后**：绿色矩形，显示坐标和尺寸

### 步骤4: 确认添加
点击 **"添加擦除区域"** 按钮
- 区域自动添加到列表
- 在预览中显示为紫色区域
- 自动退出选择模式

### 步骤5: 处理PDF
配置完所有擦除区域后，点击"移除页脚"按钮生成新PDF

---

## 🎨 颜色含义

| 颜色 | 状态 | 说明 |
|------|------|------|
| 🟡 黄色 | 正在拖动 | 显示正在选择的矩形范围和尺寸 |
| 🟢 绿色 | 已选中 | 拖动完成，等待添加到列表 |
| 🟣 紫色 | 已添加 | 已加入擦除列表，将被实际擦除 |
| 🔴 红色 | 预设区域 | 页眉/页脚通栏擦除区域 |
| 🔵 蓝色 | 预设区域 | 四个角落擦除区域 |

---

## 💡 使用技巧

### 技巧1: 精确框选
- **方法**：慢慢拖动，从目标内容的左上角开始，到右下角结束
- **提示**：黄色矩形实时显示尺寸，帮助精确控制

### 技巧2: 重新选择
如果选错了：
1. 直接再次拖动选择
2. 新选择会覆盖旧选择
3. 或点击"取消选择"退出模式

### 技巧3: 批量添加
同一页面需要擦除多个位置：
1. 框选第一个区域 → 添加
2. 再次点击"拖动选择区域"
3. 框选第二个区域 → 添加
4. 重复操作

### 技巧4: 跨页处理
需要多页擦除相同位置：
1. 在第1页框选并添加
2. 在列表中找到刚添加的区域
3. 手动修改"结束页"参数
4. 例如：起始页1 → 结束页10

---

## 📱 快捷操作

### 键盘快捷键
- **ESC键**：退出选择模式（计划中）
- **Delete键**：删除选中的列表项（计划中）

### 鼠标操作
- **单击预览**：在选择模式下开始拖动
- **拖动鼠标**：选择擦除区域
- **释放鼠标**：确认选择
- **鼠标移出画布**：自动结束当前拖动

---

## 🎯 应用场景

### 场景1: 移除页面Logo
**问题**：每页右上角有公司Logo
**操作**：
1. 切换到第1页
2. 拖动选择Logo位置
3. 添加后修改结束页为最后一页

### 场景2: 擦除水印
**问题**：第5-10页中间有"Draft"水印
**操作**：
1. 切换到第5页
2. 拖动选择水印位置
3. 添加后修改结束页为10

### 场景3: 清除签名
**问题**：最后一页底部有签名需要去除
**操作**：
1. 切换到最后一页
2. 拖动选择签名位置
3. 添加（起始页=结束页=最后一页）

### 场景4: 多区域擦除
**问题**：第1页有3个不同位置的内容要移除
**操作**：
1. 框选第1个位置 → 添加
2. 再次进入选择模式
3. 框选第2个位置 → 添加
4. 再次进入选择模式
5. 框选第3个位置 → 添加

---

## ⚠️ 注意事项

### 1. 最小尺寸限制
- 矩形宽度和高度必须 **≥ 10像素**
- 太小的选择会被自动忽略
- 如果选择被忽略，重新拖动一个更大的区域

### 2. 边界检查
- 不能超出页面边界
- 如果拖动到画布外，会自动限制在边界内

### 3. 页面切换
- 切换页面会保留选中状态
- 可以在不同页面查看选择的效果
- 但添加时会使用当前页码

### 4. 选择模式
- 激活选择模式后，鼠标光标变为十字
- 退出选择模式后，光标恢复正常
- 选择模式不影响其他设置的调整

---

## 🔧 技术细节

### 坐标系统
```
Canvas坐标 → PDF坐标
scale = 1.5 (预览缩放比例)

Canvas上的点击位置:
  clientX = 鼠标在浏览器中的X坐标
  clientY = 鼠标在浏览器中的Y坐标

转换为Canvas坐标:
  canvasX = clientX - canvas.left
  canvasY = clientY - canvas.top

转换为PDF实际坐标:
  pdfX = canvasX / scale
  pdfY = canvasY / scale
```

### 事件处理
- **mouseDown**: 开始拖动，记录起点
- **mouseMove**: 更新终点，实时渲染黄色矩形
- **mouseUp**: 完成拖动，保存为绿色矩形
- **mouseLeave**: 离开画布时自动完成拖动

### 渲染流程
```
1. 渲染PDF页面内容
2. 绘制预设擦除区域（红色/蓝色）
3. 绘制已添加的自定义区域（紫色）
4. 绘制正在拖动的矩形（黄色）
5. 绘制已选中的矩形（绿色）
```

---

## 🆚 对比手动输入

| 特性 | 拖动选择 | 手动输入坐标 |
|------|----------|-------------|
| 易用性 | ⭐⭐⭐⭐⭐ | ⭐⭐ |
| 精确度 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 速度 | ⭐⭐⭐⭐⭐ | ⭐⭐ |
| 学习成本 | 低 | 中 |
| 适用场景 | 快速定位 | 精确复制 |

**建议**：
- 常规使用：首选拖动选择
- 需要精确复制多个相同位置：使用手动输入
- 两种方式可以混合使用

---

## 🐛 故障排查

### 问题1: 拖动无反应
**原因**：未激活选择模式
**解决**：点击"拖动选择区域"按钮，确保按钮变为黄色

### 问题2: 选择太小被忽略
**原因**：矩形尺寸小于10×10像素
**解决**：拖动更大的区域，至少覆盖目标内容

### 问题3: 绿色矩形位置不对
**原因**：拖动速度太快或起点不准
**解决**：重新拖动选择，慢慢定位

### 问题4: 添加后预览没有变化
**原因**：可能当前页不在擦除范围内
**解决**：检查添加的区域的起始页/结束页设置

### 问题5: 鼠标光标不是十字
**原因**：CSS未正确加载
**解决**：刷新页面重试，或清除浏览器缓存

---

## 📈 后续优化计划

- [ ] **Shift键辅助**：按住Shift限制为正方形
- [ ] **Ctrl+Z撤销**：撤销最后一次添加
- [ ] **双击快速添加**：双击直接添加预设尺寸区域
- [ ] **拖拽调整**：已添加的区域支持拖拽调整位置和大小
- [ ] **预设模板**：保存常用的擦除配置为模板
- [ ] **批量导入**：从Excel导入多个擦除区域

---

## 🎉 总结

**拖动选择擦除功能让PDF编辑变得更简单：**

✅ **无需计算坐标** - 直接看到要擦除的位置
✅ **所见即所得** - 黄→绿→紫，清晰的视觉反馈
✅ **操作直观** - 拖、点、完成，3步搞定
✅ **效率倍增** - 比手动输入快5倍以上

**立即体验：** 访问 `/pdf-footer-remover` 页面，开始使用拖动选择功能！

---

## 💬 反馈和建议

如有问题或建议，请提供：
1. 操作步骤描述
2. 浏览器控制台截图（F12 → Console）
3. 预览截图（显示选择的矩形）
4. PDF文件特征（页数、尺寸）
