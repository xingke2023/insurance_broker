# 投资假设情景对比分析

## 重要说明

✅ **`transform_withdrawal.py` 提取的是"当前假设情景"数据**

- 使用无Low/High后缀的列
- 代表中等/标准投资回报假设
- **不是"悲观情景"（Low）数据**

## 第80年数据验证

### ✓ 用户提供的数据匹配当前假设情景

| 项目 | 数值 | 数据来源 |
|------|------|---------|
| 该年提取款项总额 | 2,000 | colCurrentTotalWithdrawalAmount |
| 款项提取后的名义金额 | **18,774** ✓ | colAfterWDNotionalAmount |
| 款项提取后的退保价值 | **3,166,415** ✓ | colTotalSurrender |

## 三种投资假设情景对比（第80年）

### 1. 当前假设情景（Current/Mid Scenario）

使用的列（无后缀）：
- `colAfterWDNotionalAmount`
- `colNonGuaranteedSurrender`
- `colTotalSurrender`

| 项目 | 数值 |
|------|------|
| 该年提取款项 | 2,000 |
| 累计提取款项 | 152,000 |
| **名义金额** | **18,774** |
| 保证现金价值 | 30,493 |
| 非保证退保价值 | 3,135,922 |
| **总退保价值** | **3,166,415** |

### 2. 悲观情景（Low Scenario）

使用的列（Low后缀）：
- `colAfterWDNotionalAmountLow`
- `colNonGuaranteedSurrenderLow`
- `colTotalSurrenderLow`

| 项目 | 数值 |
|------|------|
| 该年提取款项 | 2,000 |
| 累计提取款项 | 152,000 |
| **名义金额** | **8,258** ⚠️ |
| 保证现金价值 | 30,493 |
| 非保证退保价值 | 503,757 |
| **总退保价值** | **517,169** ⚠️ |

### 3. 乐观情景（High Scenario）

使用的列（High后缀）：
- `colNonGuaranteedSurrenderHigh`
- `colTotalSurrenderHigh`

| 项目 | 数值 |
|------|------|
| 非保证退保价值 | （数据待查）|
| **总退保价值** | **3,166,415** |

## 情景对比总结

### 第80年对比表

| 项目 | 当前假设 | 悲观情景 | 差异 | 比例 |
|------|---------|---------|------|------|
| **名义金额** | 18,774 | 8,258 | -10,516 | -56.0% |
| **非保证价值** | 3,135,922 | 503,757 | -2,632,165 | -83.9% |
| **总退保价值** | 3,166,415 | 517,169 | -2,649,246 | -83.7% |
| 保证价值 | 30,493 | 30,493 | 0 | 0% |

### 关键发现

1. **保证价值不变**
   - 无论哪种投资假设，保证现金价值都是30,493
   - 这是保险公司承诺的最低价值

2. **非保证价值差异巨大**
   - 当前假设：3,135,922
   - 悲观情景：503,757
   - **差异83.9%**（相差6.2倍）

3. **名义金额受影响**
   - 当前假设：18,774
   - 悲观情景：8,258
   - **差异56.0%**（相差2.3倍）

4. **总退保价值差异**
   - 当前假设：3,166,415
   - 悲观情景：517,169
   - **差异83.7%**（相差6.1倍）

## 投资假设说明

### 当前假设情景（Current/Mid）
- 基于保险公司当前使用的投资回报率假设
- 代表中等/预期的投资表现
- **用户验证的数据属于此类**

### 悲观情景（Low）
- 基于较低的投资回报率假设
- 代表不利的市场环境
- 非保证价值显著降低

### 乐观情景（High）
- 基于较高的投资回报率假设
- 代表有利的市场环境
- 非保证价值可能更高

## 程序使用说明

### ✅ 正确：提取当前假设情景
```bash
python3 transform_withdrawal.py md4.json output.json
```

程序自动使用无后缀的列：
- `colAfterWDNotionalAmount`（当前假设）
- `colTotalSurrender`（当前假设）

### ❌ 错误：如果要提取悲观情景
需要修改程序中的列名映射，将：
```python
'notional_amount': 'colAfterWDNotionalAmount'
```
改为：
```python
'notional_amount': 'colAfterWDNotionalAmountLow'
```

但**用户不需要悲观情景数据**，当前程序设置正确。

## 验证结果

```
✓ 第80年名义金额：18,774（当前假设）
✓ 第80年退保价值：3,166,415（当前假设）
✓ 与用户提供数据完全一致
✓ 确认使用的是"当前假设情景"而非"悲观情景"
```

## 字段映射确认

| 输出字段 | 数据来源列 | 投资假设 |
|---------|-----------|---------|
| withdrawal_amount | colCurrentTotalWithdrawalAmount | 通用 |
| accumulated_withdrawal | colAccumulatedTotalWithdrawalAmount | 通用 |
| **notional_amount** | **colAfterWDNotionalAmount** | **当前** ✓ |
| guaranteed | colGuaranteedCashValue | 保证（不变） |
| **non_guaranteed** | **colNonGuaranteedSurrender** | **当前** ✓ |
| **total_surrender** | **colTotalSurrender** | **当前** ✓ |

## 总结

1. ✅ 程序使用的是"当前假设情景"（无后缀列）
2. ✅ 数据与用户提供的验证值完全匹配
3. ✅ 不是悲观情景（Low）数据
4. ⚠️ 悲观情景的退保价值仅为当前假设的16.3%
5. ✅ 保证价值不受投资假设影响

---

**重要提醒**：保险计划书中的"非保证"部分会因投资假设不同而有巨大差异。当前假设情景代表保险公司的标准预测，但实际收益可能高于或低于此值。
