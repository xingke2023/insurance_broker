# è®¡åˆ’ä¹¦åˆ†æ­¥éª¤åˆ†æ - æƒé™æ§åˆ¶è¯´æ˜

## åŠŸèƒ½è¯´æ˜

ç³»ç»Ÿå·²å®ç°åŸºäºç”¨æˆ·ç»„çš„æƒé™æ§åˆ¶ï¼Œåªæœ‰ç‰¹å®šç”¨æˆ·æ‰èƒ½è®¿é—® **"è®¡åˆ’ä¹¦åˆ†æ­¥éª¤åˆ†æ"** åŠŸèƒ½ã€‚

## æƒé™è§„åˆ™

æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼å¯ä»¥è®¿é—®è¯¥åŠŸèƒ½ï¼š

1. **ç®¡ç†å‘˜ç”¨æˆ·**ï¼šæ‰€æœ‰ `is_staff=True` çš„ç”¨æˆ·è‡ªåŠ¨æ‹¥æœ‰è®¿é—®æƒé™
2. **plan_analyzer ç»„æˆå‘˜**ï¼šè¢«æ·»åŠ åˆ° `plan_analyzer` ç”¨æˆ·ç»„çš„æ™®é€šç”¨æˆ·

## ä½¿ç”¨ç®¡ç†è„šæœ¬

ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªä¾¿æ·çš„ç®¡ç†è„šæœ¬ `manage_user_permissions.py` æ¥ç®¡ç†ç”¨æˆ·æƒé™ã€‚

### 1. åˆ›å»ºç”¨æˆ·ç»„ï¼ˆé¦–æ¬¡ä½¿ç”¨å¿…é¡»æ‰§è¡Œï¼‰

```bash
cd /var/www/harry-insurance2
python3 manage_user_permissions.py create
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
âœ… æˆåŠŸåˆ›å»ºç”¨æˆ·ç»„: plan_analyzer
```

### 2. æˆäºˆç”¨æˆ·è®¿é—®æƒé™

```bash
python3 manage_user_permissions.py add <ç”¨æˆ·å>
```

ç¤ºä¾‹ï¼š
```bash
python3 manage_user_permissions.py add john
```

è¾“å‡ºï¼š
```
âœ… ç”¨æˆ· john å·²æ·»åŠ åˆ° plan_analyzer ç»„
   è¯¥ç”¨æˆ·ç°åœ¨å¯ä»¥è®¿é—®"è®¡åˆ’ä¹¦åˆ†æ­¥éª¤åˆ†æ"åŠŸèƒ½
```

### 3. æ’¤é”€ç”¨æˆ·è®¿é—®æƒé™

```bash
python3 manage_user_permissions.py remove <ç”¨æˆ·å>
```

ç¤ºä¾‹ï¼š
```bash
python3 manage_user_permissions.py remove john
```

è¾“å‡ºï¼š
```
âœ… ç”¨æˆ· john å·²ä» plan_analyzer ç»„ç§»é™¤
   è¯¥ç”¨æˆ·ç°åœ¨æ— æ³•è®¿é—®"è®¡åˆ’ä¹¦åˆ†æ­¥éª¤åˆ†æ"åŠŸèƒ½
```

### 4. æŸ¥çœ‹æœ‰æƒé™çš„ç”¨æˆ·åˆ—è¡¨

```bash
python3 manage_user_permissions.py list
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“‹ plan_analyzer ç»„æˆå‘˜åˆ—è¡¨ï¼ˆå…±2äººï¼‰ï¼š
   - john (john@example.com)
   - alice (alice@example.com)
```

### 5. æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·åŠæƒé™çŠ¶æ€

```bash
python3 manage_user_permissions.py list-all
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ‘¥ ç³»ç»Ÿæ‰€æœ‰ç”¨æˆ·ï¼ˆå…±5äººï¼‰ï¼š
ç”¨æˆ·å               é‚®ç®±                           ç®¡ç†å‘˜     å¯è®¿é—®åˆ†æ
----------------------------------------------------------------------
admin               admin@example.com              æ˜¯         æ˜¯
alice               alice@example.com              å¦         æ˜¯
bob                 bob@example.com                å¦         å¦
john                john@example.com               å¦         æ˜¯
mary                mary@example.com               å¦         å¦
```

## ä½¿ç”¨ Django Admin ç®¡ç†

æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ Django Admin åå°ç®¡ç†ç•Œé¢æ¥ç®¡ç†ç”¨æˆ·ç»„ï¼š

1. è®¿é—®ç®¡ç†åå°ï¼š`http://your-domain.com:8007/admin/`
2. ç™»å½•ç®¡ç†å‘˜è´¦å·
3. è¿›å…¥ **Authentication and Authorization** â†’ **Groups**
4. æ‰¾åˆ° `plan_analyzer` ç»„
5. æ·»åŠ æˆ–ç§»é™¤ç”¨æˆ·

## å‰ç«¯æ•ˆæœ

- **æœ‰æƒé™çš„ç”¨æˆ·**ï¼šåœ¨ Dashboard é¡µé¢å¯ä»¥çœ‹åˆ°"è®¡åˆ’ä¹¦åˆ†æ­¥éª¤åˆ†æ"å¡ç‰‡
- **æ— æƒé™çš„ç”¨æˆ·**ï¼šè¯¥å¡ç‰‡ä¸ä¼šæ˜¾ç¤ºåœ¨ Dashboard é¡µé¢

## æŠ€æœ¯å®ç°

### åç«¯ä¿®æ”¹
- `api/auth_views.py`ï¼šåœ¨ç™»å½•ã€æ³¨å†Œã€è·å–ç”¨æˆ·ä¿¡æ¯æ—¶è¿”å› `groups` å’Œ `is_staff` å­—æ®µ
- ä½¿ç”¨ Django é»˜è®¤çš„ Group ç³»ç»Ÿ

### å‰ç«¯ä¿®æ”¹
- `frontend/src/components/Dashboard.jsx`ï¼šæ·»åŠ  `canAccessPlanAnalyzer()` å‡½æ•°æ£€æŸ¥æƒé™
- æ ¹æ®ç”¨æˆ·ç»„åŠ¨æ€æ§åˆ¶åŠŸèƒ½å¡ç‰‡çš„æ˜¾ç¤º

## å¿«é€Ÿå…¥é—¨

1. **é¦–æ¬¡é…ç½®**ï¼š
```bash
# åˆ›å»ºç”¨æˆ·ç»„
python3 manage_user_permissions.py create

# æˆäºˆæŸä¸ªç”¨æˆ·æƒé™
python3 manage_user_permissions.py add your_username
```

2. **ç”¨æˆ·é€€å‡ºé‡æ–°ç™»å½•**ï¼š
   - ç”¨æˆ·éœ€è¦é€€å‡ºåé‡æ–°ç™»å½•ï¼Œæƒé™æ‰ä¼šç”Ÿæ•ˆ
   - æˆ–è€…æ¸…é™¤æµè§ˆå™¨ localStorage ä¸­çš„ç”¨æˆ·ä¿¡æ¯

3. **éªŒè¯æƒé™**ï¼š
   - ç™»å½•åæŸ¥çœ‹ Dashboard é¡µé¢
   - æœ‰æƒé™çš„ç”¨æˆ·ä¼šçœ‹åˆ°"è®¡åˆ’ä¹¦åˆ†æ­¥éª¤åˆ†æ"å¡ç‰‡
   - æ— æƒé™çš„ç”¨æˆ·ä¸ä¼šçœ‹åˆ°è¯¥å¡ç‰‡

## æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæˆæƒåç”¨æˆ·ä»ç„¶çœ‹ä¸åˆ°åŠŸèƒ½

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤ç”¨æˆ·å·²é€€å‡ºå¹¶é‡æ–°ç™»å½•
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ localStorage
3. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦çœŸçš„è¢«æ·»åŠ åˆ°ç»„ï¼š
   ```bash
   python3 manage_user_permissions.py list
   ```

### é—®é¢˜ï¼šè„šæœ¬æ‰§è¡ŒæŠ¥é”™

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š
   ```bash
   cd /var/www/harry-insurance2
   ```
2. ç¡®è®¤ Python ç¯å¢ƒæ­£ç¡®
3. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

## æ‰©å±•ç”¨é€”

è¿™å¥—æƒé™ç³»ç»Ÿå¯ä»¥è½»æ¾æ‰©å±•åˆ°å…¶ä»–åŠŸèƒ½ï¼š

1. åˆ›å»ºæ–°çš„ç”¨æˆ·ç»„ï¼ˆå¦‚ `premium_users`ï¼‰
2. åœ¨ Dashboard.jsx ä¸­æ·»åŠ ç±»ä¼¼çš„æƒé™æ£€æŸ¥å‡½æ•°
3. å¤åˆ¶ç®¡ç†è„šæœ¬ï¼Œä¿®æ”¹ç»„åç§°

## æ³¨æ„äº‹é¡¹

1. **ç®¡ç†å‘˜æ°¸è¿œæœ‰æƒé™**ï¼šæ‰€æœ‰ `is_staff=True` çš„ç”¨æˆ·ä¼šç»•è¿‡ç»„æ£€æŸ¥
2. **æƒé™å³æ—¶ç”Ÿæ•ˆ**ï¼šæ·»åŠ /ç§»é™¤æƒé™åï¼Œç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•æ‰èƒ½çœ‹åˆ°æ•ˆæœ
3. **æ•°æ®åº“æŒä¹…åŒ–**ï¼šç”¨æˆ·ç»„ä¿¡æ¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œé‡å¯æœåŠ¡ä¸å½±å“
